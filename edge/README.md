# Edge Devices

In an IoT setting, edge devices are the devices that are closer to the user or the data source and will be the ones responsible for interacting with the environment. In this project, we have chosen a variety of devices, each of which has its own child directory in this folder. For CIFAR-10 (and MNIST in the case of MCUs), the data is available in the repo due to its small size. For ImageNet, however, we do not include the data in the repo due to its large size. The data must be downloaded separately and placed in the appropriate directory.

There are some peculiarities in how we have managed the ImageNet data. For manipulating the data, we wanted to use `tf.keras.preprocessing.image_dataset_from_directory`, which requires the data to be in a specific format. Therefore, we have created a script to download the data and organize it in the required format due to the `image_size=(224, 224)`. Images in this dataset have inconsistent sizes, so we decided to apply a resize to maintain the aspect ratio, and then a crop so each image has the same size. This needs to be done either way, but we have instead applied it to every image and stored it so it is ready to when loaded into a program. Also, the original images downloaded from Kaggle are in the JPEG format, which means that every time they are saved and loaded, they lose some quality. To avoid this, we have converted them to PNG format.

The Raspberry Pi implementation uses this PNG images and produces correct results. However, Coral Micro requires the image to be a raw binary file, so we have created a script to convert the PNG images to raw binary files. Given that loading such binaries into a C/C++ program is trivial, we have used this format for the Jetson Orin Nano as well. The notebook in this directory shows the process followed to get both PNG and binary versions of the dataset.